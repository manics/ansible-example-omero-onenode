{
  "variables": {
    "omero_server_release": "5.6.0-m5",
    "omero_web_release": "present"
  },
  "builders": [
    {
      "type": "vagrant",
      "name": "virtualbox",
      "source_path": "centos/7",
      "box_version": "1905.1",
      "checksum_type": "none",
      "provider": "virtualbox",
      "template": "vagrantfile.template",
      "add_force": true,
      "communicator": "ssh"
    }
  ],
  "provisioners":[
    {
      "type": "file",
      "source": "../playbook.yml",
      "destination": "playbook.yml"
    },
    {
      "type": "file",
      "source": "../inventory.yml",
      "destination": "inventory.yml"
    },
    {
      "type": "file",
      "source": "../requirements.yml",
      "destination": "requirements.yml"
    },
    {
      "type": "shell",
      "inline": [
        "sudo yum install -y -q epel-release",
        "sudo yum install -y -q ansible",
        "ansible-galaxy install -p roles -r requirements.yml",
        "ansible-playbook -i inventory.yml playbook.yml -e omero_server_release={{user `omero_server_release`}} -e omero_web_release={{user `omero_web_release`}}"
      ]
    }
  ]
}
